const auth0 = require("auth0");

exports.login = (req, res) => {
  const client = new auth0.AuthenticationClient({
    domain: process.env.AUTH0_DOMAIN,
    clientId: process.env.AUTH0_CLIENT_ID,
    clientSecret: process.env.AUTH0_CLIENT_SECRET,
  });

  client.clientCredentialsGrant(
    {
      audience: process.env.AUTH0_AUDIENCE,
    },
    (err, response) => {
      if (err) {
        res.status(500).send({ message: "Please try to log in again!" });
      } else {
        res.send({
          accessToken: response.access_token,
        });
      }
    }
  );
};
